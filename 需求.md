# 需求

## 客户端

1. 客户使用

   > 点击网页即隐身登陆（匿名登陆），使用**登陆界面**来进行登陆，成为在服务器上具有聊天记录的客户
   >
   > 需添加**emoji**支持，界面仿QQ进行实现（至少需要传递图片，txt、md、docx文件，截图功能支持？） /不管传什么文件，都是文件，图片也是，前端表示没问题
   >
   > **我在看webRTC，这里前端你怎么看？**（前端的选择，我只是随口一说

2. 服务人员使用

   > 等同于复杂版的客户聊天窗口，当建立websocket的时候，需要自动地添加到服务人员的聊天窗口之中去（类似左侧添加一个bar来进行滑动，选择当前聊天的对象，同时需要新消息提醒机制） / 没问题，后端做好鉴权就行
   >
   > > 这里没有登陆界面，多出来的是聊天对象栏目
   >
   > 服务人员登陆区别于客户登录还是写死在程序之中，role为admin再进行讨论（我倾向于后者因为容易进行实现） / 鉴权使用 token 实现，可以写死，即在第一次运行时决定一个根管理员，如果你安装过一些 PHP 写的服务应该知道我的意思
   >
   > 聊天记录导出成为pdf？（脑洞，可选）/ 导出csv最好

rest api鉴权？不可以只要请求就返回响应的数据吧，应该在必要的api窗口里面都需要相应的鉴权代码。

## 服务端

转发信息，建立websocket

结构上使用servlet来进行control，tomcat进行路由分发，数据库使用mysql来进行聊天记录的储存（在实现之后需不需要支持高数量连接，加入redis什么的进行缓存？

## 技术栈一览

仓库：git

前端：vue

/ 前端 mock：nodejs/go





/ 后端：批注的内容在 / 后面

jersey：2.26-b03

包管理器：maven

java jdk：1.8.0_144

tomcat：9

### 后端思路
我们的鉴权在很多重要的api上边都需要的，使用请求头的cookie来进行鉴权

消息记录其实对应在user上就可以吧，我们可以从admin那里获取user，然后从那里请求

websocket的鉴权我觉得应该是通过拦截器来进行实现的，通过对cookie的处理来进行？session貌似在服务端可以通过getId来进行获取（看文档说是唯一的，可能通过了hash，不太清楚）



对于数据库的操作，我都在modelControl进行了控制，其余的则由rest control进行路由传递，websokct是负责websocket进行转发的



对话user的列表获取很麻烦，怎么储存才可以达到随时切换？

> 貌似模板里面提供了session的存储，所以就不用担心这个了

在collecions里面使用？是什么作用？

> 泛型的意思，这里就是我想用的存储User？？？

spring boot之中bean的概念，component的概念

> bean是java特有的一个面向对象的方式，bean为了提供向后的兼容，所以将具体实现进行了封装，只向外提供了set与get接口，供用户使用

回去之后尝试使用模板的方式返回html，如果直接返回html不行，是不是就是传回没有改动的模板？？？

>这里的原因就是jdk的问题

重构数据库表模板，重整表结构，去掉匿名用户等多个表，添加role表，使用manytomany











